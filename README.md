# Behavioural-Cloning-P3

## Explanation:

### 1. read_csv(): 

  	a. Driving_log file contains left, right and center image paths for every steering angle
  
    b. Reads driving_log file in pandas dataframe
  
    c. Image path and corresponding angles are read column wise
  
    e. As the training data has more left turns than right - additional data is generated by mirroring center images and adding a negative steering angle for the same (negative indicates right turn)

### 2. images_training, images_validation, angles_training, angles_validation = train_test_split(X, y, test_size=0.2,random_state=7)
    1. Data is split into trainig and validation data into 80:20 format (i.e., test size = 0.2)
    2. We are not spliting data for testing purpose as testing will be done on simulator

### 3. load_process_image
    1. Loads image from image path using imread
    2. Calls helper function augment_image and which returns augmented image and corresponding images
 
    Got better and faster results after reading reading Vivek's blog, before that I was using Keras generator and image augmention like this:
      train_datagen = ImageDataGenerator(
              rescale=1./255,
              shear_range=0.2,
              zoom_range=0.2,
              horizontal_flip=True)
      (More info in: https://chatbotslife.com/using-augmentation-to-mimic-human-driving-496b569760a9#.xh1deayrj)
        
### 4. height_width_augmentation
    1. Shift height and width by a small margin to simulate car begin at different postions (left/right and up/down)
    2. After shifting we will add corresponding steering angles
 
### 5. brightness_augmentation
    1. Add random brightness to simulate car beging in different lighting conditions (sunlight, shadow, dawn/dusk, steertlight, etc.,)

### 6. Other augmention methods which I tried
    I haven't used in the project but I will try it out in future; adding here for reference:
      1. Channel shifting: It is the process of taking the red, green or blue values of pixels in an image and applying those values to pixels in different positions on the image
         From Keras documentation
        def random_channel_shift(x, intensity, channel_axis=0):
            x = np.rollaxis(x, channel_axis, 0)
            min_x, max_x = np.min(x), np.max(x)
            channel_images = [np.clip(x_channel + np.random.uniform(-intensity, intensity), min_x, max_x)
                            for x_channel in x]
            x = np.stack(channel_images, axis=0)
            x = np.rollaxis(x, 0, channel_axis + 1)
            return x
      
     2. Apply random shadow:
        More info: https://chatbotslife.com/using-augmentation-to-mimic-human-driving-496b569760a9#.xh1deayrj
       
     3. CV2 transformation examples:
        http://docs.opencv.org/3.1.0/da/d6e/tutorial_py_geometric_transformations.html
       
     4. As mentioned before Keras too provides lots of image augmention parameters
        from keras.preprocessing.image import ImageDataGenerator
        datagen = ImageDataGenerator(
          rotation_range=40,
          width_shift_range=0.2,
          height_shift_range=0.2,
          rescale=1./255,
          shear_range=0.2,
          zoom_range=0.2,
          horizontal_flip=True,
          fill_mode='nearest')
### 7. crop_resize_image
      Crop the image so that car's hood and sky is removed from the image - it both removes unwanted part of the image and also leads to less overhead in computation.
      

    
    
  
                                                                         


  
